<script setup lang="ts">
const setting = EcyUtils.getLocalSetting();
const isTop = ref(false);

function moveToNavil() {
  if (isTop.value) {
    document.querySelector("#l-top-nail").scrollIntoView();
  } else {
    document.querySelector("#l-bottom-nail").scrollIntoView();
  }
  isTop.value = !isTop.value;
}

function toggleMode() {
  const html = document.querySelector("html");
  if (setting.value.theme.mode === "dark") {
    html.className = "light";
    setting.value.theme.mode = "light";
  } else {
    html.className = "dark";
    setting.value.theme.mode = "dark";
  }
}
</script>

<template>
  <div id="l-toolkits" class="fixed z-99 right-20 top-55vh l-thr-size">
    <div
      :class="{ 'show-0': setting.toolkits.pin, 'close-0': !setting.toolkits.pin }"
      class="absolute hover left-0 rd-2 l-box-bg"
      @click="EcyUtils.Router.go({ path: RouterPath.index(), router: $router })">
      <div class="f-c-c w-8 h-8">
        <i-ep-reading />
      </div>
    </div>
    <div
      :class="{ 'show-1': setting.toolkits.pin, 'close-1': !setting.toolkits.pin }"
      class="absolute hover left-0 rd-2 l-box-bg"
      @click="EcyUtils.Router.go({ path: 'back', router: $router })">
      <div class="f-c-c w-8 h-8">
        <i-ep-guide />
      </div>
    </div>
    <div
      :class="{ 'show-2': setting.toolkits.pin, 'close-2': !setting.toolkits.pin }"
      class="absolute hover left-0 rd-2 l-box-bg"
      @click="moveToNavil">
      <div class="f-c-c w-8 h-8">
        <i-ep-add-location v-show="isTop" />
        <i-ep-delete-location v-show="!isTop" />
      </div>
    </div>
    <div
      :class="{ 'show-3': setting.toolkits.pin, 'close-3': !setting.toolkits.pin }"
      class="absolute hover left-0 rd-2 l-box-bg"
      @click="EcyUtils.Router.go({ path: RouterPath.profile(), router: $router })">
      <div class="f-c-c w-8 h-8">
        <i-ep-warning />
      </div>
    </div>
    <div
      :class="{ 'show-4': setting.toolkits.pin, 'close-4': !setting.toolkits.pin }"
      class="absolute hover left-0 rd-2 l-box-bg"
      @click="toggleMode">
      <div class="f-c-c w-8 h-8">
        <i-ep-moon v-show="setting.theme.mode === 'dark'" />
        <i-ep-sunny v-show="setting.theme.mode === 'light'" />
      </div>
    </div>
    <div
      :class="{ 'show-5': setting.toolkits.pin, 'close-5': !setting.toolkits.pin }"
      class="absolute hover left-0 rd-2 l-box-bg"
      @click="EcyUtils.Router.go({ path: 'https://i.cnblogs.com' })">
      <div class="f-c-c w-8 h-8">
        <i-ep-setting />
      </div>
    </div>
    <div
      @click="setting.toolkits.pin = !setting.toolkits.pin"
      :class="{ 'show-toolkits': setting.toolkits.pin, 'close-toolkits': !setting.toolkits.pin }"
      class="kits-box absolute hover top-60 left-0 rd-2 l-box-bg">
      <div class="f-c-c w-8 h-8">
        <i-ep-more />
      </div>
    </div>
  </div>
</template>

<style scoped lang="scss">
$show-top: 0;
$show-anitime: 0.2s;
$close-top: 15rem;
$close-anitime: 0.6s;
$move-step: 2.5rem;

@for $index from 0 to 6 {
  @if $index != 0 {
    $show-top: $show-top + $move-step;
  }

  .show-#{$index} {
    $show-anitime: $show-anitime + math.div($index, 10);
    animation: show-#{$index}-animation $show-anitime ease-in;
    top: $show-top;
  }

  .close-#{$index} {
    $close-anitime: $close-anitime - math.div($index, 10);
    animation: close-#{$index}-animation $close-anitime ease-in;
    top: $close-top;
    z-index: -1;
  }

  @keyframes show-#{$index}-animation {
    $step: $close-top;

    @for $i from 0 to 11 {
      #{$i * 10%} {
        top: $step;
        $step: $step - math.div($close-top - $index * $move-step, 10);
      }
    }
  }

  @keyframes close-#{$index}-animation {
    @for $i from 0 to 11 {
      #{ $i * 10%} {
        top: $show-top + $i * math.div($close-top - $show-top, 10);
      }
    }
  }
}

.show-toolkits {
  animation: show-toolkits-animation 0.3s ease-in;
  transform: rotate(0);
}

.close-toolkits {
  animation: close-toolkits-animation 0.3s ease-in;
  transform: rotate(180deg);
}

@keyframes show-toolkits-animation {
  @for $index from 0 to 10 {
    #{$index * 10%} {
      transform: rotate(180deg - $index * 18deg);
    }
  }
}

@keyframes close-toolkits-animation {
  @for $index from 0 to 10 {
    #{$index * 10%} {
      transform: rotate($index * 18deg);
    }
  }
}
</style>
